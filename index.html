<!DOCTYPE html>
<html>
<head>
    <title>Jeu de Serpent</title>
    <style>
        #gameArea {
            width: 400px;
            height: 400px;
            border: 1px solid black;
        }
        .button {
            width: 50px;
            height: 50px;
        }
        #controlPanel {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }
        #verticalButtons {
            display: flex;
            flex-direction: column;
        }
        #leftButton, #rightButton {
            margin: 0 20px;
        }
    </style>
</head>
<body>
    <canvas id="gameArea" width="400" height="400"></canvas>
    <div id="controlPanel">
        <button id="leftButton" class="button">Gauche</button>
        <div id="verticalButtons">
            <button id="upButton" class="button">Haut</button>
            <button id="downButton" class="button">Bas</button>
        </div>
        <button id="rightButton" class="button">Droite</button>
    </div>

    <script>
        const gameArea = document.getElementById('gameArea');
        const context = gameArea.getContext('2d');
        const size = 40; // Taille des segments du serpent
        const gameAreaWidth = gameArea.width;
        const gameAreaHeight = gameArea.height;
        let snake = [{ x: 160, y: 160 }];
        let dx = size, dy = 0;
        let foodX, foodY;

        const snakeHeadImg = new Image();
        snakeHeadImg.src = 'tete-serpent.png';

        const snakeBodyImg = new Image();
        snakeBodyImg.src = 'corps-serpent.png';

        const appleImg = new Image();
        appleImg.src = 'pomme.png';

        function randomFood() {
            foodX = Math.floor(Math.random() * (gameAreaWidth / size)) * size;
            foodY = Math.floor(Math.random() * (gameAreaHeight / size)) * size;
        }

        function drawFood() {
            context.drawImage(appleImg, foodX, foodY, size, size);
        }

        function createFood() {
            randomFood();
            // Vérifier que la nourriture n'est pas placée sur le serpent
            snake.forEach(part => {
                const foodIsOnSnake = part.x == foodX && part.y == foodY;
                if (foodIsOnSnake)
                    createFood();
            });
        }

        function drawSnake() {
            snake.forEach((part, index) => {
                context.save();
                if (index === 0) {
                    // Rotation de la tête du serpent
                    context.translate(part.x + size / 2, part.y + size / 2);
                    let angle = Math.atan2(dy, dx);
                    context.rotate(angle);
                    context.drawImage(snakeHeadImg, -size / 2, -size / 2, size, size);
                } else {
                    context.drawImage(snakeBodyImg, part.x, part.y, size, size);
                }
                context.restore();
            });
        }

        function moveSnake() {
            const head = { x: snake[0].x + dx, y: snake[0].y + dy };
            snake.unshift(head);

            // Vérifier la collision avec la nourriture
            if (snake[0].x === foodX && snake[0].y === foodY) {
                createFood(); // Créer une nouvelle nourriture
            } else {
                snake.pop(); // Retirer la queue si pas de nourriture
            }
        }

        function update() {
            moveSnake();
            drawSnake();
            drawFood();
        }

        createFood();
        setInterval(update, 200); // Vitesse réduite

        document.getElementById('upButton').addEventListener('click', function() { dx = 0; dy = -size; });
        document.getElementById('downButton').addEventListener('click', function() { dx = 0; dy = size; });
        document.getElementById('leftButton').addEventListener('click', function() { dx = -size; dy = 0; });
        document.getElementById('rightButton').addEventListener('click', function() { dx = size; dy = 0; });
    </script>
</body>
</html>
