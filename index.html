<!DOCTYPE html>
<html>
<head>
    <title>Jeu de Serpent</title>
    <style>
        #gameArea {
            width: 400px;
            height: 400px;
            border: 1px solid black;
        }
        .button {
            width: 50px;
            height: 50px;
        }
        #controlPanel {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }
        #verticalButtons {
            display: flex;
            flex-direction: column;
        }
        #leftButton, #rightButton {
            margin: 0 20px;
        }
    </style>
</head>
<body>
    <canvas id="gameArea" width="400" height="400"></canvas>
    <div id="controlPanel">
        <button id="leftButton" class="button">Gauche</button>
        <div id="verticalButtons">
            <button id="upButton" class="button">Haut</button>
            <button id="downButton" class="button">Bas</button>
        </div>
        <button id="rightButton" class="button">Droite</button>
    </div>

    <script>
        const gameArea = document.getElementById('gameArea');
        const context = gameArea.getContext('2d');
        const size = 30;
        const gameAreaWidth = 400;
        const gameAreaHeight = 400;
        let snake = [{ x: 200, y: 200 }];
        let dx = size, dy = 0;
        let foodX, foodY;

        const snakeHeadImg = new Image();
        snakeHeadImg.src = 'tete-serpent.png';

        const snakeBodyImg = new Image();
        snakeBodyImg.src = 'corps-serpent.png';

        const appleImg = new Image();
        appleImg.src = 'pomme.png';

        function randomFood(min, max) {
            return Math.round((Math.random() * (max - min) + min) / size) * size;
        }

        function drawFood() {
            context.drawImage(appleImg, foodX, foodY, size, size);
        }

        function createFood() {
            foodX = randomFood(0, gameAreaWidth - size);
            foodY = randomFood(0, gameAreaHeight - size);
        }

        function drawSnake() {
            snake.forEach((snakePart, index) => {
                context.save();
                if (index === 0) {
                    let angle = 0;
                    if (dx === size) angle = 90;
                    else if (dx === -size) angle = -90;
                    else if (dy === -size) angle = 0;
                    else if (dy === size) angle = 180;

                    context.translate(snakePart.x + size / 2, snakePart.y + size / 2);
                    context.rotate(angle * Math.PI / 180);
                    context.drawImage(snakeHeadImg, -size / 2, -size / 2, size, size);
                } else {
                    context.drawImage(snakeBodyImg, snakePart.x, snakePart.y, size, size);
                }
                context.restore();
            });
        }

        function wrapPosition(position, max) {
            if (position < 0) {
                return max - size;
            } else if (position >= max) {
                return 0;
            }
            return position;
        }

        function checkFoodCollision() {
            if (snake[0].x === foodX && snake[0].y === foodY) {
                createFood();
                return true;
            }
            return false;
        }

        function update() {
            context.clearRect(0, 0, gameAreaWidth, gameAreaHeight);

            let headX = snake[0].x + dx;
            let headY = snake[0].y + dy;

            headX = wrapPosition(headX, gameAreaWidth);
            headY = wrapPosition(headY, gameAreaHeight);

            const head = { x: headX, y: headY };
            snake.unshift(head);

            if (!checkFoodCollision()) {
                snake.pop();
            }

            drawSnake();
            drawFood();
        }

        createFood();
        setInterval(update, 100);

        document.getElementById('upButton').addEventListener('click', function() { dx = 0; dy = -size; });
        document.getElementById('downButton').addEventListener('click', function() { dx = 0; dy = size; });
        document.getElementById('leftButton').addEventListener('click', function() { dx = -size; dy = 0; });
        document.getElementById('rightButton').addEventListener('click', function() { dx = size; dy = 0; });
    </script>
</body>
</html>
